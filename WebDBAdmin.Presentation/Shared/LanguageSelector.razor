@using System.Globalization
@using Microsoft.AspNetCore.Components
@using MudBlazor
@inject NavigationManager NavigationManager
@inject Microsoft.Extensions.Localization.IStringLocalizer<WebDBAdmin.Presentation.Resources.SharedResource> Loc

<MudMenu Icon="@Icons.Material.Filled.Language" Style="color:#757575" AnchorOrigin="Origin.BottomCenter"
         TransformOrigin="Origin.TopCenter" Dense="true">
    <MudMenuItem OnClick="@(() => OnCultureChanged("en-US"))">ğŸ‡ºğŸ‡¸ English</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("es-ES"))">ğŸ‡ªğŸ‡¸ EspaÃ±ol</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("de-DE"))">ğŸ‡©ğŸ‡ª Deutsch</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("fr-FR"))">ğŸ‡«ğŸ‡· FranÃ§ais</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("it-IT"))">ğŸ‡®ğŸ‡¹ Italiano</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("pt-PT"))">ğŸ‡µğŸ‡¹ PortuguÃªs</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("nl-NL"))">ğŸ‡³ğŸ‡± Nederlands</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("sv-SE"))">ğŸ‡¸ğŸ‡ª Svenska</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("nb-NO"))">ğŸ‡³ğŸ‡´ Norsk</MudMenuItem>
    <MudMenuItem OnClick="@(() => OnCultureChanged("el-GR"))">ğŸ‡¬ğŸ‡· Î•Î»Î»Î·Î½Î¹ÎºÎ¬</MudMenuItem>
</MudMenu>

@code {
    private void OnCultureChanged(string value)
    {
        if (value is string culture)
        {
            var uri = new Uri(NavigationManager.Uri)
            .GetComponents(UriComponents.PathAndQuery, UriFormat.Unescaped);
            var query = $"?culture={Uri.EscapeDataString(culture)}&redirectUri={Uri.EscapeDataString(uri)}";
            NavigationManager.NavigateTo($"/Culture/Set{query}", forceLoad: true);
        }
    }
}